<!DOCTYPE html>
<html lang='en'>
<meta name='viewport' content='width=device-width, initial-scale=1.0'>

<head>
    <title>LED Controller</title>
    <link href='https://fonts.googleapis.com/css2?family=Comfortaa&display=swap' rel='stylesheet'>
    <style>
        body {
            font-family: 'Comfortaa', cursive;
            background-color: #cccccc;
            Color: #000088;
        }

        h1 {
            font-size: 10vw;
            margin-top: 1vw;
            margin-bottom: 1vw;
        }

        h3 {
            font-size: 6vw;
            margin-bottom: 1vw;
        }

        select {
            width: min(75vw, 600px);
            font-size: min(6vw, 30px);
        }
    </style>
</head>

<body>
    <h3><i>Forrest and Brian's</i></h3>
    <h1>LED Controller</h1>
    <center>
        <select onchange='change()'>
            %%%OPTIONS%%%
        </select>
        <div id='s'></div>
        <i id='fps'></i>
    </center>
</body>
<script>
    let newData = false;
    setInterval(send, 100);
    setInterval(getFPS, 1500);
    const inputs = [];
    const s = document.getElementsByTagName('select')[0];
    s.selectedIndex = %i;
    document.getElementById('s').innerHTML = inputs[s.options[s.selectedIndex].text][0];
    function change() {
        document.getElementById('s').innerHTML = inputs[s.options[s.selectedIndex].text][0];
        u();}
    function getFPS() {
        let xmlHttp = new XMLHttpRequest();
        xmlHttp.onload = () => {
            document.getElementById('fps').innerHTML = xmlHttp.responseText + " fps";
        };
        xmlHttp.open('GET', '/gt', true);
        xmlHttp.send(null);
    }
    function u() { newData = true; }
    function send() {
        if (newData) {
            let xmlHttp = new XMLHttpRequest();
            const params = {};
            for (let i = 0; i < inputs[s.options[s.selectedIndex].text][1]; i++) {
                if(document.getElementById('' + i).type === 'checkbox'){params['p' + i] = document.getElementById('' + i).checked;}
                else{params['p' + i] = document.getElementById('' + i).value;}
            }
            xmlHttp.open('GET', '/set?s=' + s.selectedIndex + '&' + new URLSearchParams(params).toString(), true);
            xmlHttp.send(null);
            newData = false;
        }
    }
</script>
</html>